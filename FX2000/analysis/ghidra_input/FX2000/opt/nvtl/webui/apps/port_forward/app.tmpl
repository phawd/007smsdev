<tmpl_if isHidden>
	 <div class="notification app error">
			 <tmpl_var _("webui", "webui_app_hidden_text")>
	 </div>
<tmpl_else>
<script type="text/javascript">
	/* <![CDATA[ */
	function checkBoxToggled(isDefaultApp, checked, index)
	{
		var tmpID = "";
		if (isDefaultApp) {
			tmpID = "#routerPortForwardInfoDefaultIpAddressTextBox" + index;
		} else {
			tmpID = $("#customInformationRow_" + index).find(":input").not(":checkbox");
		}
		if (checked) {
			$(tmpID).prop("disabled", false);
		} else {
			$(tmpID).prop("disabled", true);
			if (isDefaultApp) $(tmpID).val("");
		}
	}

	function changePortLabels(elem, index)
	{
		if (elem.value === "Single") {
			$("#customAppBeginPortIndexLabel" + index).html('<tmpl_var _("webui", "adv_port_forward_single_port_begin_port_label")>');
			$("#customAppEndPortIndexLabel" + index).html('<tmpl_var _("webui", "adv_port_forward_single_port_end_port_label")>');
		} else if (elem.value === "Translate") {
			$("#customAppBeginPortIndexLabel" + index).html('<tmpl_var _("webui", "adv_port_forward_translate_port_begin_port_label")>');
			$("#customAppEndPortIndexLabel" + index).html('<tmpl_var _("webui", "adv_port_forward_translate_port_end_port_label")>');
		} else {
			$("#customAppBeginPortIndexLabel" + index).html('<tmpl_var _("webui", "adv_port_forward_port_range_begin_port_label")>');
			$("#customAppEndPortIndexLabel" + index).html('<tmpl_var _("webui", "adv_port_forward_port_range_end_port_label")>');
		}
	}

	function PortForwardToggled(bool, $toggleSwitchElement)
	{
		if(jQuery.fn.slideButton) $toggleSwitchElement.slideButton("addLoader");
		if(bool && ("<tmpl_var dmzActive>" == "1")) {                                                                                                       
                	modalPopup.createWindow('<tmpl_var _("webui", "webui_app_warning_title")>', '<p><tmpl_var _("webui", "adv_port_forward_model_text")></p>', 530, "auto", [{
                        	text : '<tmpl_var _("webui", "webui_modal_ok_button")>',                                                         
                        	className : "primary",                                                                                        
                        	trigger : function(){                                                                                         
                                	undoChange($toggleSwitchElement); 
                        	}                                                                                                             
                	}], null, function(){
					undoChange($toggleSwitchElement);
            		}); 
			if(jQuery.fn.slideButton) $toggleSwitchElement.slideButton("removeLoader");                                                                                                          
        	} else {
			var url = (bool) ? "<tmpl_udf GET_URI('port_forward_enable')>" : "<tmpl_udf GET_URI('port_forward_disable')>";
			$.ajax({
				url : url,
				type : "POST",
				data : {
					gSecureToken : "<tmpl_var gSecureToken>"
				},
				dataType : "json",
				success : function(data, textStatus, xhr) {
					if ( (xhr.readyState == 4 ) && (xhr.status == 0) ) {
						undoChange($toggleSwitchElement);
					}
				},
				error : function(xhr, textStatus, errorThrown) {
					undoChange($toggleSwitchElement);
					// If auth session has ended, force a new login with a fresh GET.
					if( (xhr.status == 401) || (xhr.status == 403) || (xhr.status == 406) ) window.location.replace(window.location.href);
				},
				complete : function(xhr, textStatus) {
					if(jQuery.fn.slideButton) $toggleSwitchElement.slideButton("removeLoader");
				}
			});
		}
	}

	function undoChange($el)
	{
		if(jQuery.fn.slideButton) $el.slideButton("undo");
	}

	$(function()
	{
		<tmpl_if portForwardDisplayStandardApps>
			var customAppLimit = 10;
		<tmpl_else>
			var customAppLimit = 100;
		</tmpl_if>

		//Setup the Port Forwarding Toggle Button.
		if (jQuery.fn.slideButton) {
			$("#portForwardEnable").slideButton({
				change : function($input) {
					PortForwardToggled($input.is(":checked"), $input);
				}
 			});
		}

		if ($("tr.customPortInformationRow").length >= customAppLimit) {
			$(".addCustomApp").hide();
		} else {
			$(".addCustomApp").show();
		}

		<tmpl_unless isLocked>
		$("#addCustomAppLink").on("click", function(e) {
			e.preventDefault();
			$("#portForwardingCustomApplicationsList thead").show();
			var numCustomApps = $("tr.customPortInformationRow").length;
			var customRowID = numCustomApps + 1;
			var Row = $('<tr id="customInformationRow_' + customRowID + '" class="portInformationRow customPortInformationRow">');
			Row.append('<td class="checkbox"><label for="customAppEnabledIndex' + customRowID + '" style="display:none;"><tmpl_var _("webui", "webui_app_on_text")></label><input type="checkbox" checked="checked" id="customAppEnabledIndex' + customRowID + '" name="customAppEnabledIndex' + customRowID + '" onchange="checkBoxToggled(false, checked, ' + customRowID + ')"></td>');
			Row.append("<td class='portName'><label for='customAppNameIndex" + customRowID + "' style='display:none;'><tmpl_var _('webui', 'adv_port_forward_app_name_label')></label><input type='text' value='Custom App " + customRowID + "' name='customAppNameIndex" + customRowID + "' maxlength='24' id='customAppNameIndex" + customRowID + "' class='customPortApplicationName  text'><input type='hidden' value='0' name='customAppInstanceIndex" + customRowID + "  id='customAppInstanceIndex" + customRowID + "'></td>");
			Row.append('<td class="portIpAddress"><label for="customAppIpAddressIndex' + customRowID + '" style="display:none;"><tmpl_var _("webui", "adv_port_forward_ip_address_label")></label><input type="text" value="" name="customAppIpAddressIndex' + customRowID + '" maxlength="15" id="customAppIpAddressIndex' + customRowID + '" class="customPortApplicationIpAddress  text"></td>');
			<tmpl_if showPortType>
				Row.append('<td class="portMap" id="portMapContainer' + customRowID + '"><label for="customAppPortMapIndex' + customRowID + '" style="display:none;"><tmpl_var _("webui", "adv_port_forward_port_type_label")></label></td>');
				var portMapSelect = '<select class="short" name="customAppPortMapIndex' + customRowID + '" id="customAppPortMapIndex' + customRowID + '" onchange="changePortLabels(this, ' + customRowID + ')"><option value="Range" selected="selected"><tmpl_var _("webui","adv_port_forward_port_type_range")></option>';
				<tmpl_if showSinglePortType>
				portMapSelect += '<option value="Single"><tmpl_var _("webui","adv_port_forward_port_type_single")></option>';
				</tmpl_if>
				<tmpl_if showTranslatePortType>
				portMapSelect += '<option value="Translate"><tmpl_var _("webui","adv_port_forward_port_type_translate")></option>';
				</tmpl_if>
				portMapSelect += '</select>';
				Row.find('#portMapContainer' + customRowID).append(portMapSelect);
				Row.append('<td class="portBegin"><label for="customAppBeginPortIndex' + customRowID + '" id="customAppBeginPortIndexLabel' + customRowID + '"><tmpl_var _("webui", "adv_port_forward_port_range_begin_port_label")></label><input type="text" value="" name="customAppBeginPortIndex' + customRowID + '" id="customAppBeginPortIndex' + customRowID + '" maxlength="5" size="5" class="portNumber text"></td>');
				Row.append('<td class="portEnd"><label for="customAppEndPortIndex' + customRowID + '" id="customAppEndPortIndexLabel' + customRowID + '"><tmpl_var _("webui", "adv_port_forward_port_range_end_port_label")></label><input type="text" value="" name="customAppEndPortIndex' + customRowID + '" id="customAppEndPortIndex' + customRowID + '" maxlength="5" size="5" class="portNumber text"></td>');
			<tmpl_else>
				Row.append('<td class="portBegin"><label for="customAppBeginPortIndex' + customRowID + '" id="customAppBeginPortIndexLabel' + customRowID + '"><input type="text" value="" name="customAppBeginPortIndex' + customRowID + '" id="customAppBeginPortIndex' + customRowID + '" maxlength="5" size="5" class="portNumber text"></td>');
				Row.append('<td class="portEnd"><label for="customAppEndPortIndex' + customRowID + '" id="customAppEndPortIndexLabel' + customRowID + '"><input type="text" value="" name="customAppEndPortIndex' + customRowID + '" id="customAppEndPortIndex' + customRowID + '" maxlength="5" size="5" class="portNumber text"></td>');
			</tmpl_if>
			Row.append('<td class="portProtocol" id="portProtocolContainer' + customRowID + '"><label for="customAppPortTypeIndex' + customRowID + '" style="display:none;"><tmpl_var _("webui", "adv_port_forward_protocol_label")></label></td>');
			var protocolSelect = $('<select class="short" name="customAppPortTypeIndex' + customRowID + '" id="customAppPortTypeIndex' + customRowID + '"><option value="' + $.uiEnums.PORTTYPE_TCP + '">TCP</option><option value="' + $.uiEnums.PORTTYPE_UDP + '">UDP</option><tmpl_if showTCPUDP><option value="' + $.uiEnums.PORTTYPE_TCPUDP + '">TCP/UDP</option></tmpl_if></select>');
			Row.find('#portProtocolContainer' + customRowID).append(protocolSelect);
			Row.append('<td class="checkbox"><label for="customAppDeleteIndex' + customRowID + '" style="display:none;"><tmpl_var _("webui", "webui_app_delete_text")></label><input type="checkbox" id="customAppDeleteIndex' + customRowID + '" name="customAppDeleteIndex' + customRowID + '"></td>');

			// Add uniform to Select And Checkbox.
			if (jQuery.uniform) {
				// This is for uniform 1 and uniform 2 compatibility.
				var uniformOptions = (typeof $.uniform.options !== "undefined") ? $.uniform.options : $.uniform.defaults;
				if (uniformOptions.filter) {
					Row.find(uniformOptions.filter).uniform();
				}
			}
			$("#portForwardingCustomApplicationsList").append(Row);
			if ($("tr.customPortInformationRow").length >= customAppLimit) {
				$(".addCustomApp").hide();
			}
		});
		</tmpl_unless>

		$(".portType").on("change", function() {
			var id = parseInt($(this).attr("id"));
			if ($("#portType option:selected").html() === '<tmpl_var _("webui", "adv_port_forward_port_type_range")>') {
				$("#motionDetection").hide();
				$("#driverBehavior").show();
			} else {
				$("#driverBehavior").hide();
				$("#motionDetection").show();
			}
		});

		// Used so that disabled inputs will still be submitted to the CGI
		$("#portForwardingAppsForm").on("submit", function(){ $(this).find(":input").prop("disabled", false); });
	});
	/* ]]> */
</script>

<tmpl_if isLocked>
	<div class="notification app error">
		<tmpl_var _("webui", "webui_app_locked_text")>
	</div>
</tmpl_if>

<tmpl_if isIpPassthroughActive>
	<p class="warning">
		<tmpl_var _("webui", "adv_port_forward_ip_passthrough_active_warning_text")>
	</p>
<tmpl_else>
	<tmpl_if errorCount>
		<div class="notification app error">
			<div class="notification_inner">
				<p>
					<tmpl_var _('webui','webui_save_code_failed_text')>
				</p>
			</div>
		</div>
	</tmpl_if>

	<tmpl_if gPostSuccess>
		<div class="notification app success">
			<div class="notification_inner">
				<p>
					<tmpl_var _("webui", "webui_save_code_success_text")>
				</p>
			</div>
		</div>
	</tmpl_if>

	<tmpl_if showHeaderText>
		<h2 class="sectionHead"><tmpl_var _("webui", "adv_port_forward_subheader_text")></h2>
	</tmpl_if>

	<tmpl_if showIntroductoryText>
		<p>
			<tmpl_var _("webui", "adv_port_forward_enable_help")>
		</p>
		<tmpl_if vpnEnabled>
			<p>
				<tmpl_var _("webui", "adv_port_forward_vpn_enable_note_text")>
			</p>
		</tmpl_if>
		<div class="toggleSettingContainer align-field" id="enablePortForwardingToggle">
			<div class="form-group">
				<label for="portForwardEnable">
					<h3>
						<tmpl_var _("webui", "adv_port_forward_enable_label" )>
					</h3>
				</label>
				<div class="toggle">
					<input class="toggleSwitchCheckbox" type="checkbox" id="portForwardEnable" name="portForwardEnable" <tmpl_if
						PortForwardingEnabled> checked="checked"</tmpl_if>
					<tmpl_if isIpPassthroughActive> disabled="disabled"</tmpl_if>
					<tmpl_if isLocked>disabled="disabled"</tmpl_if> />
				</div>
			</div>
		</div>
		<!--/.toggleSettingContainer-->
	<tmpl_else>
		<tmpl_if vpnEnabled>
			<p>
				<tmpl_var _("webui", "adv_port_forward_vpn_enable_note_text_top")>
			</p>
		</tmpl_if>
		<div class="toggleSettingContainer align-field" id="enablePortForwardingToggle">
			<div class="form-group">
				<label for="portForwardEnable">
					<h3>
						<tmpl_var _("webui", "adv_port_forward_enable_label" )>
					</h3>
				</label>
				<div class="toggle">
					<input class="toggleSwitchCheckbox" type="checkbox" id="portForwardEnable" name="portForwardEnable" <tmpl_if
						PortForwardingEnabled> checked="checked"</tmpl_if>
					<tmpl_if isIpPassthroughActive> disabled="disabled"</tmpl_if>
					<tmpl_if isLocked>disabled="disabled"</tmpl_if> />
				</div>
				<p>
					<tmpl_var _("webui", "adv_port_forward_enable_help" )>
				</p>
				<tmpl_if vpnEnabled>
					<p>
						<tmpl_var _("webui", "adv_port_forward_vpn_enable_note_text" )>
					</p>
				</tmpl_if>
			</div>
		</div>
		<!--/.toggleSettingContainer-->
	</tmpl_if>

	<tmpl_if showPortForwardApplicationsSubHeading>
		<h2 class="sectionHead"><tmpl_var _("webui", "adv_port_forward_applications_sub_heading")></h2>
	</tmpl_if>

	<form method="POST" action="<tmpl_udf GET_URI('port_forward')>" id="portForwardingAppsForm">
					<tmpl_if portForwardDisplayStandardApps>
			<fieldset class="first" id="defaultPortForwardingFieldset">
				<p class="">
					<tmpl_var _("webui", "adv_port_forward_apps_intro")>
				</p>

				<table id="portForwardingApplicationsList" class="portForwardingTable">
					<colgroup>
						<col class="checkbox" />
						<col class="title" />
						<col class="portIpAddress" />
					</colgroup>
					<thead>
						<tr class="headingRow">
							<th class="applicationOnHeading"><tmpl_var _("webui", "webui_application_on_text")></th>
							<th class="applicationHeading"><tmpl_var _("webui", "adv_port_forward_application_heading")></th>
							<th class="ipAddressHeading"><tmpl_var _("webui", "adv_port_forward_ip_address_heading")></th>
						</tr>
					</thead>
					<tbody>
					<!-- List of Default Ports -->
					<tmpl_foreach routerDefaultPortForwardList as item>
						<tr class="portInformationRow defaultPortsRow">
							<td class="checkbox">
								<h4><label for="routerPortForwardInfoDefaultEnabledCheckBox<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var item.routerPortForwardInfoDefaultName><tmpl_var _("webui", "adv_port_forward_app_checkbox_label")></label></h4>
								<input type="checkbox" name="routerPortForwardInfoDefaultEnabledCheckBox<tmpl_var (item.__index__ + 1)>" id="routerPortForwardInfoDefaultEnabledCheckBox<tmpl_var (item.__index__ + 1)>"
								<tmpl_if item.routerPortForwardInfoDefaultEnabled>checked="checked"</tmpl_if> onchange="checkBoxToggled(true, checked, <tmpl_var (item.__index__ + 1)>)" />
							</td>
							<td class="portName">
								<h4><label for="routerPortForwardInfoDefaultInstanceHidden<tmpl_var (item.__index__ + 1)>">
									<tmpl_var item.routerPortForwardInfoDefaultName>
								</label></h4>
								<input class="hidden index" type="hidden" name="routerPortForwardInfoDefaultInstanceHidden<tmpl_var (item.__index__ + 1)>" id="routerPortForwardInfoDefaultInstanceHidden<tmpl_var (item.__index__ + 1)>" value="<tmpl_var item.routerPortForwardInfoDefaultInstance>" />
							</td>
							<td class="portIpAddress">
								<h4><label for="routerPortForwardInfoDefaultIpAddressTextBox<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var item.routerPortForwardInfoDefaultName><tmpl_var _("webui", "adv_port_forward_app_checkbox_label")></label></h4>
								<input class="text portIpAddress" type="text" name="routerPortForwardInfoDefaultIpAddressTextBox<tmpl_var (item.__index__ + 1)>" id="routerPortForwardInfoDefaultIpAddressTextBox<tmpl_var (item.__index__ + 1)>" value="<tmpl_var item.routerPortForwardInfoDefaultIpAddress>"<tmpl_unless item.routerPortForwardInfoDefaultEnabled> disabled="disabled"</tmpl_unless> />
								<tmpl_if item.defaultAppIpAddressIndexError>
									<p class="error">
										<tmpl_var item.defaultAppIpAddressIndexError>
									</p>
								</tmpl_if>
							</td>
							<tmpl_if item.routerPortForwardInfoDefaultStartPortError>
							<td class="portBegin">
								<p class="error">
									<tmpl_var item.routerPortForwardInfoDefaultStartPort>
									<tmpl_if (item.routerPortForwardInfoDefaultStartPort != item.routerPortForwardInfoDefaultEndPort)>
										- <tmpl_var item.routerPortForwardInfoDefaultEndPort>
									</tmpl_if>
								</p>
							</td>
							</tmpl_if>
						</tr>
					</tmpl_foreach>
					</tbody>
				</table>
			</fieldset><!-- End List of Default Ports -->
					</tmpl_if>

		<fieldset id="defaultPortForwardFieldset">
			<!-- Start List of Custom Ports -->
			<div id="port_forwarding_custom_applications_title" class="table_header clearfix portForwardingApplicationsTitle">
				<h2 class="sectionHead"><tmpl_var _("webui", "adv_port_forward_user_defined_sub_header")></h2>
			</div>
			<p class="">
				<tmpl_var _("webui", "adv_port_forward_user_defined_intro")>
			</p>
			<div class="wideTableWrap">
				<table id="portForwardingCustomApplicationsList" class="portForwardingTable">
					<colgroup>
						<col class="checkbox" />
						<col class="title" />
						<col class="portIpAddress" />
						<col class="portNumberStart" />
						<col class="portNumberStop" />
						<col class="portProtocol" />
						<col class="checkbox" />
					</colgroup>
					<thead <tmpl_if routerCustomPortForwardList><tmpl_else>style="display: none;"</tmpl_if>>
						<tr>
							<th><tmpl_var _("webui", "webui_app_on_text")></th>
							<th><tmpl_var _("webui", "adv_port_forward_app_name_label")></th>
							<th><tmpl_var _("webui", "adv_port_forward_ip_address_label")></th>
							<tmpl_if showPortType>
								<th><tmpl_var _("webui", "adv_port_forward_port_type_label")></th>
								<th colspan="2"> <tmpl_var _("webui", "adv_port_forward_port_numbers_label")></th>
							<tmpl_else>
								<th><tmpl_var _("webui", "adv_port_forward_begin_port_label")></th>
								<th><tmpl_var _("webui", "adv_port_forward_end_port_label")></th>
							</tmpl_if>
							<th><tmpl_var _("webui", "adv_port_forward_protocol_label")></th>
							<th><tmpl_var _("webui", "webui_app_delete_text")></th>
						</tr>
					</thead>
					<tbody>
					<tmpl_if routerCustomPortForwardList>
						<tmpl_foreach routerCustomPortForwardList as item>
						<tr class="portInformationRow customPortInformationRow<tmpl_if item.routerPortForwardInfoCustomRowError> error</tmpl_if>" id="customInformationRow_<tmpl_var (item.__index__ + 1)>">
							<td class="checkbox">
								<h4><label for="customAppEnabledIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "webui_app_on_text")></label></h4>
								<input type="checkbox" name="customAppEnabledIndex<tmpl_var (item.__index__ + 1)>" id="customAppEnabledIndex<tmpl_var (item.__index__ + 1)>"<tmpl_if item.routerPortForwardInfoCustomEnabled> checked="checked"</tmpl_if> onchange="checkBoxToggled(false, checked, <tmpl_var (item.__index__ + 1)>)" />
							</td>
							<td class="portName">
								<h4><label for="customAppNameIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "adv_port_forward_app_name_label")></label></h4>
								<input class="customPortApplicationName<tmpl_if customAppNameIndexError> error</tmpl_if>" type="text" maxlength="24"
									id="customAppNameIndex<tmpl_var (item.__index__ + 1)>" name="customAppNameIndex<tmpl_var (item.__index__ + 1)>"
									value="<tmpl_var item.routerPortForwardInfoCustomName>" />
								<tmpl_if item.customAppNameIndexError>
									<p class="error">
										<tmpl_var item.customAppNameIndexError>
									</p>
								</tmpl_if>
								<input type="hidden" name="customAppInstanceIndex<tmpl_var (item.__index__ + 1)>" id="customAppInstanceIndex<tmpl_var (item.__index__ + 1)>" value="<tmpl_var routerPortForwardInfoCustomInstance>" />
							</td>
							<td class="portIpAddress">
								<h4><label for="customAppIpAddressIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "adv_port_forward_ip_address_label")></label></h4>
								<input class="customPortApplicationIpAddress<tmpl_if item.customAppIpAddressIndexError> error</tmpl_if>" type="text" maxlength="15"
									id="customAppIpAddressIndex<tmpl_var (item.__index__ + 1)>" name="customAppIpAddressIndex<tmpl_var (item.__index__ + 1)>"
									value="<tmpl_var item.routerPortForwardInfoCustomIpAddress>" />
								<tmpl_if item.customAppIpAddressIndexError>
									<p class="error">
										<tmpl_var item.customAppIpAddressIndexError>
									</p>
								</tmpl_if>
							</td>
							<tmpl_if showPortType>
								<td class="portMap">
									<h4><label for="customAppPortMapIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "adv_port_forward_port_type_label")></label></h4>
									<select class="dynamic short" name="customAppPortMapIndex<tmpl_var (item.__index__ + 1)>" id="customAppPortMapIndex<tmpl_var (item.__index__ + 1)>" onchange="changePortLabels(this, <tmpl_var (item.__index__ + 1)>)">
										<option value="Range"<tmpl_if IN_SET(item.routerPortForwardInfoCustomPortMapType, "Range")> selected="selected"</tmpl_if>><tmpl_var _("webui","adv_port_forward_port_type_range")></option>
									<tmpl_if showSinglePortType>
										<option value="Single"<tmpl_if IN_SET(item.routerPortForwardInfoCustomPortMapType, "Single")> selected="selected"</tmpl_if>><tmpl_var _("webui","adv_port_forward_port_type_single")></option>
									</tmpl_if>
									<tmpl_if showTranslatePortType>
										<option value="Translate"<tmpl_if IN_SET(item.routerPortForwardInfoCustomPortMapType, "Translate")> selected="selected"</tmpl_if>><tmpl_var _("webui","adv_port_forward_port_type_translate")></option>
									</tmpl_if>
									</select>
								</td>
							</tmpl_if>
							<td class="portBegin">
								<tmpl_if showPortType>
									<h4><label for="customAppBeginPortIndex<tmpl_var (item.__index__ + 1)>" id="customAppBeginPortIndexLabel<tmpl_var (item.__index__ + 1)>">
										<tmpl_if IN_SET(item.routerPortForwardInfoCustomPortMapType, "Translate")>
											<tmpl_var _("webui", "adv_port_forward_translate_port_begin_port_label")>
										<tmpl_elsif IN_SET(item.routerPortForwardInfoCustomPortMapType, "Single")>
											<tmpl_var _("webui", "adv_port_forward_single_port_begin_port_label")>	
										<tmpl_else>
											<tmpl_var _("webui", "adv_port_forward_port_range_begin_port_label")>
										</tmpl_if>
									</label></h4>
								<tmpl_else>
									<h4><label for="customAppBeginPortIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "adv_port_forward_begin_port_label")></label></h4>
								</tmpl_if>
								<input class="portNumber<tmpl_if customAppBeginPortIndexError> error</tmpl_if>" type="text" size="5" maxlength="5"
									id="customAppBeginPortIndex<tmpl_var (item.__index__ + 1)>" name="customAppBeginPortIndex<tmpl_var (item.__index__ + 1)>" value="<tmpl_var item.routerPortForwardInfoCustomStartPort>" />
								<tmpl_if item.customAppBeginPortIndexError>
									<p class="error">
										<tmpl_var item.customAppBeginPortIndexError>
									</p>
								</tmpl_if>
							</td>
							<td class="portEnd">
								<tmpl_if showPortType>
									<h4><label for="customAppEndPortIndex<tmpl_var (item.__index__ + 1)>" id="customAppEndPortIndexLabel<tmpl_var (item.__index__ + 1)>">
										<tmpl_if IN_SET(item.routerPortForwardInfoCustomPortMapType, "Translate")>
											<tmpl_var _("webui", "adv_port_forward_translate_port_end_port_label")>
										<tmpl_elsif IN_SET(item.routerPortForwardInfoCustomPortMapType, "Single")>
											<tmpl_var _("webui", "adv_port_forward_single_port_end_port_label")>	
										<tmpl_else>
											<tmpl_var _("webui", "adv_port_forward_port_range_end_port_label")>
										</tmpl_if>
									</label></h4>
								<tmpl_else>
									<h4><label for="customAppEndPortIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "adv_port_forward_end_port_label")></label></h4>
								</tmpl_if>
								<input class="portNumber<tmpl_if item.customAppEndPortIndexError> error</tmpl_if>" type="text" size="5" maxlength="5"
									id="customAppEndPortIndex<tmpl_var (item.__index__ + 1)>" name="customAppEndPortIndex<tmpl_var (item.__index__ + 1)>" value="<tmpl_var item.routerPortForwardInfoCustomEndPort>" />
								<tmpl_if item.customAppEndPortIndexError>
									<p class="error">
										<tmpl_var item.customAppEndPortIndexError>
									</p>
								</tmpl_if>
							</td>
							<td class="portProtocol">
								<h4><label for="customAppPortTypeIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "adv_port_forward_protocol_label")></label></h4>
								<select class="dynamic short" name="customAppPortTypeIndex<tmpl_var (item.__index__ + 1)>" id="customAppPortTypeIndex<tmpl_var (item.__index__ + 1)>">
									<option value="TCP"<tmpl_if IN_SET(item.routerPortForwardInfoCustomProtocol, "TCP")> selected="selected"</tmpl_if> >TCP</option>
									<option value="UDP"<tmpl_if IN_SET(item.routerPortForwardInfoCustomProtocol, "UDP")> selected="selected"</tmpl_if> >UDP</option>
									<tmpl_if showTCPUDP>
										<option value="TCPUDP"<tmpl_if IN_SET(item.routerPortForwardInfoCustomProtocol, "TCPUDP")> selected="selected"</tmpl_if> >TCP/UDP</option>
									</tmpl_if>
								</select>
							</td>
							<td class="checkbox">
								<h4><label for="customAppDeleteIndex<tmpl_var (item.__index__ + 1)>" style="display:none;"><tmpl_var _("webui", "webui_app_delete_text")></label></h4>
								<input type="checkbox" name="customAppDeleteIndex<tmpl_var (item.__index__ + 1)>" id="customAppDeleteIndex<tmpl_var (item.__index__ + 1)>" />
							</td>
						</tr>
						</tmpl_foreach>
					</tmpl_if>
					</tbody>
				</table>
			</div>
		</fieldset>

		<tmpl_if showAddCustomAppButton>
			<div class="button_container align-right clearfix">
				<button type="button" class="secondary addCustomApp" id="addCustomAppLink"><tmpl_var _("webui", "adv_port_forward_add_custom_app_link")></button>				
		<tmpl_else>
			<a <tmpl_unless isLocked>href="#"</tmpl_unless> <tmpl_if isLocked>style="text-decoration:none;color:#ccc;"</tmpl_if> id="addCustomAppLink" class="addCustomApp"><tmpl_var _("webui", "adv_port_forward_add_custom_app_link")></a>
		</tmpl_if>
			<input type="hidden" name="gSecureToken" id="gSecureToken" value="<tmpl_var gSecureToken>" />
			<button type="submit" id="submit" class="primary" <tmpl_if isLocked>disabled="disabled"</tmpl_if> >
				<tmpl_var _("webui", "webui_save_button")>
			</button>
		</div>
	</form>
</tmpl_if>
</tmpl_if><!-- isHidden -->
