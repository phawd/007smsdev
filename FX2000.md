FX2000 Forensic Extraction & Analysis Report
Generated: 2025-12-12T06:40:04Z

Summary
-------
This report documents the static analysis performed on files pulled from the FX2000 device into the local FX2000/ directory. Focus is on /opt (FX2000/opt/...), with additional system files also collected. The raw extraction files produced during collection and analysis are stored under FX2000/ (e.g., FX2000_bin_strings.txt, FX2000_lib_strings.txt, FX2000_secrets.txt, FX2000_opt_elfs.txt, FX2000_executables_list.txt).

Methodology
-----------
- Pulled /opt and common root directories from the device (excluding /sys and /dev).
- Used file(1) to classify binaries and libraries.
- Extracted printable strings (strings(1)) for bins and libs and saved them under FX2000/.
- Attempted dynamic tracing (strace) locally but failed because the downloaded binaries are ARM 32-bit ELF objects and cannot be executed on this x86 host (Exec format error). Dynamic analysis must be run on an ARM host or under qemu-user/qemu-user-static emulation with correct interpreter.
- Performed lightweight disassembly attempts using capstone in a Python venv for initial inspection (capstone installed in fx2000venv). For thorough static reverse engineering, import ELF files into Ghidra or IDA Pro on a host with sufficient memory and CPU.
- Searched recursively for sensitive strings and keys and saved matches to FX2000/FX2000_secrets.txt.

Key Findings (high level)
-------------------------
- The /opt/nvtl tree contains a full web UI, daemons, and many libraries.
- Many ELF binaries in /opt/nvtl/bin are 32-bit ARM (ELF 32-bit LSB, ARM, EABI5). Some are stripped; others include debug_info.
- The web UI uses many app.so modules (C++ symbols present) under /opt/nvtl/webui/apps/*.so implementing page components and device logic.
- There are multiple cryptographic artifacts and certificates present in /opt/nvtl/etc and /opt/nvtl/bin and /opt/nvtl/data (see Sensitive Findings below).

Sensitive Findings (high priority)
---------------------------------
See FX2000/FX2000_secrets.txt for raw matches. Highlights found by the automated grep include (paths are relative to the repo root):
- FX2000/opt/nvtl/bin/private.pem  (private key file present)
- FX2000/opt/nvtl/bin/public.pem   (public key)
- FX2000/opt/nvtl/data/deviceagent/devagent_client.key  (device agent client private key)
- FX2000/opt/nvtl/data/deviceagent/devagent_client.pem  (device agent client certificate)
- FX2000/opt/nvtl/etc/fota/device.pem  (FOTA certificate)
- FX2000/opt/nvtl/etc/nua/* (device certs and keys present)
- FX2000/opt/nvtl/data/sms/sms_inbox.db and FX2000/opt/nvtl/data/sms/sms_history.txt (user SMS data)
- Numerous .pem and .key files under FX2000/opt/nvtl/etc and FX2000/opt/nvtl/data (see FX2000_secrets.txt for full list)

These files contain cryptographic material or personally identifiable communications (SMS DB) and should be treated as sensitive.

Binary & Library Characteristics
--------------------------------
- All examined ELF binaries under FX2000/opt are ARM 32-bit (ELF 32-bit LSB, ARM, EABI5). Example binaries: ans_cli, ansd, atcmd, bckrst_cli, bckrstd, cloud_engined, deviceagentd, modem2d, vpnd, many others.
- Many libraries exist under FX2000/opt/nvtl/lib, e.g., libmodem2_api.so, libmifi_config.so, libmifi_debug.so, libmifimsgbus.so, libs such as libxmldata_api.so. Several libs provide device-specific APIs (sim_mgr, gps, wifi, vpn, fota, etc.).
- C++ symbols in webui app.so modules indicate a modular page/component architecture; these modules interface with the web front-end (lighttpd/fastcgi).

Limitations and Notes
---------------------
- Dynamic tracing (strace) and running binaries was attempted locally but fails on x86 host due to architecture mismatch (ARM ELFs). To run these binaries and capture runtime behavior and syscalls, use an ARM environment or qemu-user-static with proper loader (/lib/ld-linux-armhf.so.3) and chroot /proc mount as needed.
- Capstone was installed in a Python virtual environment for small disassembly attempts, but a thorough static reverse-engineering workflow should use Ghidra/IDA with ARM processor module and run full function analysis. Ghidra will allow decompilation and easier cross-references.

Artifacts produced (local)
-------------------------
- FX2000/FX2000_bin_strings.txt  -- aggregated strings() output from many /opt/nvtl/bin files
- FX2000/FX2000_lib_strings.txt  -- aggregated strings() output from /opt/nvtl/lib/*.so
- FX2000/FX2000_cgi_strings.txt  -- strings from CGI executables (webui.cgi, getGPSStatus.cgi)
- FX2000/FX2000_secrets.txt      -- grep results for likely sensitive strings (keys, certs, tokens, password occurrences)
- FX2000/FX2000_opt_elfs.txt     -- list of ELF files detected under FX2000/opt with file(1) output
- FX2000/FX2000_opt_elfs_count.txt -- number of ELF files reported (one-line count file)
- FX2000/FX2000_executables_list.txt -- list of executable files under FX2000/opt
- FX2000/FX2000_analysis_sample.txt -- sample output summary produced during analysis

Recommended next steps (for deeper analysis)
--------------------------------------------
1. Sensitive material handling
   - Immediately restrict access to the extracted FX2000/ directory; move to an encrypted analysis host if not already.
   - If extracting secret values (private keys) for legitimate recovery, ensure they are stored in secure vaults and rotated on device fleet if keys were exposed.

2. Dynamic analysis
   - Set up an ARM-compatible environment (ARM VM or qemu-user-static). Example quick approach:
     - On a Linux host: apt-get install qemu-user-static; copy /usr/bin/qemu-arm-static into chroot, bind-mount /proc and /sys; run binaries and capture strace output.
   - Run key daemons (carefully, in isolated environment) and use strace/ltrace to capture syscall behavior.

3. Static reverse engineering
   - Import selected ELF(s) (e.g., libmodem2_api.so, modem2d, webui app.so modules) into Ghidra and run analysis. Focus on functions that handle SMS, NV item access, QMI, and authentication.
   - Use the not-stripped libraries (those with debug_info) first â€” they provide symbol names and types that speed up understanding.

4. Secrets enumeration
   - Review FX2000/FX2000_secrets.txt and manually inspect any matched files. Look for literal private keys (-----BEGIN ... PRIVATE KEY-----), credentials in config.xml files, or hard-coded tokens.

5. Export actionable indicators
   - Produce a redaction-safe list of command names, interfaces, and library calls related to modem access (QMI libraries, diag, AT interpretors) to integrate into testing/automation tools.

Important file locations to inspect immediately
---------------------------------------------
- FX2000/opt/nvtl/bin/private.pem
- FX2000/opt/nvtl/bin/public.pem
- FX2000/opt/nvtl/data/deviceagent/devagent_client.key
- FX2000/opt/nvtl/data/deviceagent/devagent_client.pem
- FX2000/opt/nvtl/etc/fota/device.pem
- FX2000/opt/nvtl/data/sms/sms_inbox.db
- FX2000/opt/nvtl/data/sms/sms_history.txt
- FX2000/opt/nvtl/lib/*.so  (esp. libmodem2_api.so, libmal_qct.so, libqmi*.so)

Where to find raw outputs
------------------------
- FX2000/FX2000_secrets.txt
- FX2000/FX2000_bin_strings.txt
- FX2000/FX2000_lib_strings.txt
- FX2000/FX2000_opt_elfs.txt
- FX2000/FX2000_executables_list.txt

Concluding notes
----------------
This report is an initial static reconnaissance and sensitive-data enumeration. It intentionally does not modify any collected files. For full protocol- and logic-level understanding, perform deeper static RE in Ghidra and dynamic tracing in an ARM-compatible sandbox. If desired, next actions can include: (A) produce a prioritized list of binaries to reverse (by connectivity/privilege), (B) extract and redact private keys and provide a secure backup to the owner, (C) create automated scripts to run the most important tools under qemu and capture runtime behavior.

End of report.

Ghidra Headless Export Summary
-----------------------------
- Export directory: FX2000/analysis/ghidra_exports
- Number of exported files: 159
- Sample exported files (first 10):
dmcall_functions.csv
dmcall_strings.csv
dmcall_summary.md
dsmd_functions.csv
dsmd_strings.csv
dsmd_summary.md
factory_reset_cli_functions.csv
factory_reset_cli_strings.csv
factory_reset_cli_summary.md
iwpriv_functions.csv

Notes:
- For each imported ELF, Ghidra produced <program>_functions.csv, <program>_strings.csv and <program>_summary.md where present.
- Use the CSVs for automated parsing of functions and string->function cross references.
- Sensitive strings previously identified are also present in these exports; review FX2000/analysis/ghidra_exports/*_strings.csv for context and references.

End of report.
