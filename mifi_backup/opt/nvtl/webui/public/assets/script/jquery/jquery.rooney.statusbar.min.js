/**
 * rooney.statusBar jQuery Plug-in
 *
 * Copyright 2016 Novatel Wireless (http://www.nvtl.com/)
 *
 * Date:   2016-08-10
 * Rev:    1.2
 * Author: John C. Scott <joscott@nvtl.com>
 */
!function(c){var s=null,m={},r={},e={},u=0,a={url:"/srv/status",groupClass:"status clearfix",battNumOfBars:4,lowBatteryThreshold:15,pollingRate:5e3,errorMax:2},n=!1,i=!1,o=!1,l=!1,d=!1;c.statusBar=function(t){return C(),B[t]?B[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void c.error("Method "+t+" does not exist in jQuery.statusBar"):B.init.apply(this,arguments)},c.fn.statusBar=function(t){var a=this,s=arguments;return C(),a.each(function(){if(S[t])return S[t].apply(a,Array.prototype.slice.call(s,1));c.error("Method "+t+" does not exist in jQuery.fn.statusBar")})};var B={version:function(){return"1.0 (Rooney)"},init:function(t){(m=c.extend(!0,a,t)).statusBars&&!c.isEmptyObject(m.statusBars)?(c.each(m.statusBars,function(t){var a=m.statusBars[t].name;r[a]=c(E(m.statusBars[t].structure)),e[a]=a}),R()):c.error("No status bar(s) defined.")},destroy:function(t){void 0!==t&&""!==t?(B.stop(t),r[t].remove(),delete r[t]):(B.stop(),c.each(m.statusBars,function(t){var a=m.statusBars[t].name;r[a].remove(),delete r[a],delete e[a]}))},start:function(t){void 0!==t&&""!==t?p(t)&&(e[t]=t):R()},autoStop:function(t,a){void 0!==a&&""!==a?setTimeout(function(){B.stop(a)},t):setTimeout(B.stop,t)},stop:function(t){void 0!==t&&""!==t?delete e[t]:clearTimeout(s)},refresh:function(t,a){var s=t||0,e=a||"";B.stop(e),0<s?setTimeout(function(){B.start(e)},s):B.start(e)}},S={attach:function(t){r[t]?c(this).empty().append(r[t]):c.error("The jQuery.statusBar has not been properly initialized.")}},h={updateAirplaneMode:function(t,a){var s=y(a,"statusBarAirplaneMode");if(s){var e=N(a,"keys","statusBarAirplaneMode");if(-1<c.inArray("statusBarAirplaneMode",e)&&f(t.statusBarAirplaneMode)&&t.statusBarAirplaneMode===c.uiEnums.RADIO_OFF)return T(a,"hide",["statusBarTechnology","statusBarTrafficStatus","statusBarSignalBars","statusBarNetwork","statusBarConnectionState","statusBarFemtoCellStatus","statusBarSimStatus","statusBarSimCarrierBlockedStatus"]),s.removeClass().addClass("airplane_"+v(t.statusBarAirplaneMode)),h.updateBatteryStatus(t,a),h.updateConnectedDevicesStatus(t,a),!1;s.removeClass().parent().hide(),T(a,"show",["statusBarTechnology","statusBarTrafficStatus","statusBarSignalBars","statusBarNetwork","statusBarConnectionState","statusBarSimStatus","statusBarSimCarrierBlockedStatus"])}},updateSimStatus:function(t,a){var s=y(a,"statusBarSimStatus");if(s){var e=N(a,"keys",["statusBarSimStatus","statusBarSimCarrierBlockedStatus"]),r="sim_ready",u="";if(-1<c.inArray("statusBarSimStatus",e)&&f(t.statusBarSimStatus)&&(t.statusBarSimStatus!==c.uiEnums.SIMSTATUS_READY||t.statusBarSimStatus!==c.uiEnums.SIMSTATUS_UNLOCKED))switch(r="sim_"+v(t.statusBarSimStatus),t.statusBarSimStatus){case c.uiEnums.SIMSTATUS_NOT_FOUND:u=m.simNoSimText,d=!0;break;case c.uiEnums.SIMSTATUS_PIN_LOCKED:u=m.simPinLockedText,l=!0;break;case c.uiEnums.SIMSTATUS_PUK_LOCKED:u=m.simPukLockedText,l=!0;break;case c.uiEnums.SIMSTATUS_NOT_SUPPORTED:u=m.simInvalidText,o=!0;break;case c.uiEnums.SIMSTATUS_ERROR:f(t.statusBarSimCarrierBlockedStatus)&&t.statusBarSimCarrierBlockedStatus===c.uiEnums.BOOLTYPE_NUMERIC_TRUE?(r="sim_invalid",u=m.simInvalidText):(r="sim_error",u=m.simErrorText),o=!0}if(""!==u)return T(a,"hide",["statusBarFemtoCellStatus","statusBarRoaming","statusBarTrafficStatus","statusBarTechnology"]),_(a,"hide",["mobileStatusBarFemtoCellStatus","mobileStatusBarRoaming"]),s.parent("li").show(),s.parents("ul").addClass("sim_status_error"),s.removeClass().addClass("text "+r).html(u),h.updateBatteryStatus(t,a),h.updateConnectedDevicesStatus(t,a),h.updateAirplaneMode(t,a),h.updateSignalStrengthStatus(t,a),h.updateNetworkStatus(t,a),h.updateMobileNetworkStatus(t,a),!1;d=l=o=!1,s.parents("ul").removeClass("sim_status_error"),s.removeClass().html("").parents("li, ul").hide(),s.removeClass().html("").parent("li").hide(),T(a,"show",["statusBarFemtoCellStatus","statusBarRoaming","statusBarTrafficStatus","statusBarTechnology"]),_(a,"show",["statusBarSignalBars"])}},updateWanTechStatus:function(t,a){var s=y(a,"statusBarConnectionState");if(s){var e=N(a,"keys","statusBarConnectionState"),r="";if(-1<c.inArray("statusBarConnectionState",e)&&f(t.statusBarConnectionState))switch(t.statusBarConnectionState){case c.uiEnums.WANSTATE_NOSERVICE:r=m.wanNoServiceText,n=!0;break;case c.uiEnums.WANSTATE_SEARCHING:r=m.wanSearchingText,i=!0;break;case c.uiEnums.WANSTATE_PCO5:r=m.wanNoServiceText,n=!0}if(""!==r)return T(a,"hide",["statusBarFemtoCellStatus","statusBarRoaming","statusBarTrafficStatus","statusBarTechnology"]),_(a,"hide",["mobileStatusBarFemtoCellStatus","mobileStatusBarRoaming"]),s.parent("li").show(),s.parents("ul").addClass("wan_tech_error"),s.removeClass().addClass("text nopadding wan_tech_error").html(r),h.updateBatteryStatus(t,a),h.updateConnectedDevicesStatus(t,a),h.updateAirplaneMode(t,a),h.updateSignalStrengthStatus(t,a),h.updateNetworkStatus(t,a),h.updateMobileNetworkStatus(t,a),!1;i=n=!1,s.parents("ul").removeClass("wan_tech_error"),s.removeClass().html("").parents("li, ul").hide(),s.removeClass().html("").parent("li").hide(),T(a,"show",["statusBarFemtoCellStatus","statusBarRoaming","statusBarTrafficStatus","statusBarTechnology"]),_(a,"show",["statusBarSignalBars"])}},updateBatteryStatus:function(t,a){var s=["statusBarBatteryChargingSource","statusBarBatteryChargingState","statusBarBatteryPercent","statusBarBatteryDetection"],e=y(a,s);if(e){var r=N(a,"keys",s),u="batt_none";if(-1<c.inArray("statusBarBatteryDetection",r)&&f(t.statusBarBatteryDetection)&&t.statusBarBatteryDetection===c.uiEnums.BATTERY_DETECTION_PRESENT){var n="";if(-1<c.inArray("statusBarBatteryChargingSource",r)&&f(t.statusBarBatteryChargingSource)&&t.statusBarBatteryChargingSource!==c.uiEnums.CHARGINGSOURCE_NONE&&(n=v(t.statusBarBatteryChargingSource)+"_"),-1<c.inArray("statusBarBatteryPercent",r)&&f(t.statusBarBatteryPercent)&&-1<t.statusBarBatteryPercent){var i=t.statusBarBatteryPercent,o=t.statusBarBatteryPercent+"%";if(i<=m.lowBatteryThreshold)u="batt_"+n+"low";else{var l=100/m.battNumOfBars;u="batt_"+n+Math.round(i/l)}}}e.removeClass().addClass(u).text(o)}},updateConnectedDevicesStatus:function(t,a){var s=y(a,["statusBarWiFiClientListSize","statusBarWiFiEnabled"]);s&&(f(t.statusBarWiFiEnabled)&&0==t.statusBarWiFiEnabled?s.empty().removeClass().addClass("tethered_usb"):s.empty().removeClass())},updateFemtoRoamStatus:function(t,a){var s=y(a,["statusBarFemtoCellStatus","statusBarRoaming"]);if(s){var e=t.statusBarRoaming,r="femto_roam_none";f(t.statusBarRoaming)&&e!==c.uiEnums.ROAMNONE&&s.removeClass().text("R"),f(t.statusBarFemtoCellStatus)&&t.statusBarFemtoCellStatus===c.uiEnums.BOOLTYPE_NUMERIC_TRUE&&(r="femto_on",s.removeClass().text("").addClass(r))}},updateMobileFemtoRoamStatus:function(t,a){var s=y(a,["mobileStatusBarFemtoCellStatus","mobileStatusBarRoaming"]);if(s){s.parent("li").show();var e=t.statusBarRoaming;f(t.statusBarRoaming)&&e!==c.uiEnums.ROAMNONE||f(t.statusBarFemtoCellStatus)&&t.statusBarFemtoCellStatus===c.uiEnums.BOOLTYPE_NUMERIC_TRUE?(f(t.statusBarRoaming)&&e!==c.uiEnums.ROAMNONE&&(s.removeClass().text("R"),!0),f(t.statusBarFemtoCellStatus)&&t.statusBarFemtoCellStatus===c.uiEnums.BOOLTYPE_NUMERIC_TRUE&&(s.removeClass().text("").addClass("femto_on"),!1)):(s.removeClass().addClass("femto_roam_none"),s.parent("li").hide(),!1)}},updateNetworkStatus:function(t,a){var s=y(a,["statusBarNetwork","statusBarNetworkID"]);if(s){var e=t.statusBarNetwork;s.removeClass().addClass("text network_name").text(e)}},updateMobileNetworkStatus:function(t,a){var s=y(a,["mobileStatusBarNetwork","mobileStatusBarNetworkID"]);if(s){var e="";n||i||o||l||d?(s.removeClass().text(""),s.parent("li").hide()):(f(t.statusBarNetwork)&&(e=t.statusBarNetwork),s.parent("li").show(),s.removeClass().addClass("text network_name").text(e))}},updateSignalStrengthStatus:function(t,a){var s=y(a,"statusBarSignalBars");s&&(n?s.removeClass().addClass("no_service"):o?s.removeClass().addClass("sim_error"):l?s.removeClass().addClass("sim_locked"):d?s.removeClass().addClass("sim_no_sim"):f(t.statusBarSignalBars)?s.removeClass().addClass("rssi_"+t.statusBarSignalBars):s.removeClass().addClass("rssi_0"))},updateTechStatus:function(t,a){var s=y(a,"statusBarTechnology");if(s){var e="tech_none";if(f(t.statusBarTechnology)){var r=t.statusBarTechnology;t.statusBarConnectionState===c.uiEnums.WANSTATE_PCO3?e="tech_4glte_slash":r===c.uiEnums.WANTECH_NONE?_(a,"hide",["statusBarTechnology"]):r===c.uiEnums.WANTECH_EVDO_EHRPD||r===c.uiEnums.WANTECH_EVDO||r===c.uiEnums.WANTECH_EVDO_REVA||r===c.uiEnums.WANTECH_EVDO_REVB||r===c.uiEnums.WANTECH_UMTS||r===c.uiEnums.WANTECH_HSPA_PLUS||r===c.uiEnums.WANTECH_HSPA_PLUS_DC?e="tech_3g":r===c.uiEnums.WANTECH_LTE&&(e="tech_4glte"),s.removeClass().addClass(e)}}},updateTrafficStatus:function(t,a){var s=y(a,"statusBarTrafficStatus");if(s){var e="activity_none";f(t.statusBarTrafficStatus)&&(e="activity_"+v(t.statusBarTrafficStatus)),s.removeClass().addClass(e)}}},C=function(){c.uiEnums||c.error("Can't find jQuery.uiEnums object.")},f=function(t){return void 0!==t&&""!==t},p=function(a){var s=!1;return c.each(r,function(t){if(r[t]===a)return!(s=!0)}),s||c.error('Status bar named, "'+a+'", has not been instantiated.'),s},v=function(t){return t.toLowerCase().replace(/ /g,"_")},E=function(t){var s="";return c.each(t,function(t,a){s+='<ul id="'+t+'" class="'+m.groupClass+'" style="display:none;">',c.each(a,function(t){s+='<li id="item_'+t+'"><span id="'+t+'" style="display:none;"></span></li>'}),s+="</ul>"}),s},T=function(t,r,u){c.each(m.statusBars[t].structure,function(e,t){c.each(t,function(t,s){c.each(u,function(t){if(-1<c.inArray(u[t],s)){var a=c("#"+e);"hide"===r&&a.hide(),"show"===r&&a.children(":hidden").length!=a.children().length&&a.show()}})})})},_=function(t,n,i){c.each(m.statusBars[t].structure,function(u,t){c.each(t,function(e,r){c.each(i,function(t){if(-1<c.inArray(i[t],r)){var a=c("#"+u),s=c("#"+e);"hide"===n&&(s.removeClass().hide(),s.parent("li").hide(),a.children(":hidden").length==a.children().length&&a.hide()),"show"===n&&(a.show(),s.parent("li").show(),s.show()),g(a)}})})})},y=function(t,a){var s=null,e=N(t,"id",a,!0);return""!==e&&((s=0<c("#"+e).length?c("#"+e):r[t].find("#"+e)).parents("li, ul").show(),s.show(),g(s.parent("li").parent("ul"))),s},g=function(t){1==t.children(":visible").length?t.children(":visible").css({"margin-left":0,"margin-right":0}):t.children(":visible").css({"margin-left":"","margin-right":""})},N=function(t,a,e,s){var r=void 0!==s&&s,u="",n=[];return c.each(m.statusBars[t].structure,function(t,a){c.each(a,function(a,s){c.isArray(e)?r?0==c(e).not(s).length&&0==c(s).not(e).length&&(u=a,n=s):c.each(e,function(t){-1<c.inArray(e[t],s)&&(u=a,n=s)}):-1<c.inArray(e,s)&&(u=a,n=s)})}),"id"===a?u:"keys"===a?n:void 0},A=function(){++u>m.errorMax&&(u=0,m.errorCallback&&m.errorCallback())},R=function(){if(!h)return c.error("Status bar updating methods are not defined."),!1;c.ajax({url:m.url,type:"GET",dataType:"json",timeout:2*m.pollingRate,cache:!1,success:function(s,t,a){4==a.readyState&&0<a.status?(u=0,c.each(e,function(t,a){c.each(h,function(t){return h[t].call(this,s.statusData,a)})}),m.successCallback&&m.successCallback()):A()},error:function(t,a,s){"error"==a?A():"timeout"==a&&m.timeoutCallback&&m.timeoutCallback()},complete:function(t,a){m.completeCallback&&m.completeCallback(),m.pollingRate?s=setTimeout(R,m.pollingRate):R()}})}}(jQuery);