<script type="text/javascript">
/* <![CDATA[ */
var linkClicked = false;
var isPco3 = "<tmpl_var isPcoThree>";
var isPco5 = "<tmpl_var isPcoFive>";
var connected = "<tmpl_var connected>";
$(function()
{
    $(document).ajaxSuccess(function(e, xhr, settings) {
        if((xhr.responseText) && (settings.dataType == "json")) {
            try {
                var obj = jQuery.parseJSON(xhr.responseText || "null");
                if(typeof obj.statusData.statusBarSimStatus !== "undefined") {
                    if(obj.statusData.statusBarSimStatus == $.uiEnums.SIMSTATUS_READY) {
                        if((typeof obj.statusData.pcoInitiatedConnectionStatus !== "undefined") && (obj.statusData.pcoInitiatedConnectionStatus == $.uiEnums.WANSTATE_CONNECTED)) {
                            if(isPco3 === "1" || isPco5 === "1") {
                                $("#buttons").hide();
                                $("#intro1Text").hide();
                                $("#spinner").hide();
                                if("<tmpl_var isPcoThree>" == "1") {
                                    $("#warningText").removeAttr('class').addClass("warning").html('<tmpl_var _("webui", "pco_limited_internet_access_text")>');
                                    $("#introText").html("<tmpl_var _('webui', 'pco_three_limited_internet_access_intro_text')>&nbsp;<a  target='_blank' href='<tmpl_udf GET_EXTERNAL_URI('provider_pco_verizon_link')>'><tmpl_var _('webui', 'pco_verizon_link_text')></a>&nbsp;<tmpl_udf GET_PO_TEXT('pco_three_limited_internet_access_intro1_text', gProductName)>");
                                } else if("<tmpl_var isPcoFive>" == "1") {  
                                    $("#warningText").removeAttr('class').addClass("warning").html('<tmpl_var _("webui", "pco_add_data_plan_text")>');
                                    $("#introText").html("<tmpl_var _('webui', 'pco_five_limited_internet_access_intro_text')>&nbsp;<a target='_blank' href='<tmpl_udf GET_EXTERNAL_URI('provider_pco_verizon_link')>'><tmpl_var _('webui', 'pco_verizon_link_text')></a>&nbsp;<tmpl_udf GET_PO_TEXT('pco_five_limited_internet_access_intro1_text', gProductName)>");
                                }
                                $("#warningText").show();
                                $("#introText").show();
				linkClicked = false;
                            }
                        }							
                    }
                }
            } catch(e) {}
        }
    });

    if(isPco3 === "1" || isPco5 === "1") {
        if(connected === "1") {
            $("#buttons").hide();
            $("#intro1Text").hide();
            if("<tmpl_var isPcoThree>" == "1") {
                $("#warningText").removeAttr('class').addClass("warning").html('<tmpl_var _("webui", "pco_limited_internet_access_text")>');
                $("#introText").html("<tmpl_var _('webui', 'pco_three_limited_internet_access_intro_text')>&nbsp;<a  target='_blank' href='<tmpl_udf GET_EXTERNAL_URI('provider_pco_verizon_link')>'><tmpl_var _('webui', 'pco_verizon_link_text')></a>&nbsp;<tmpl_udf GET_PO_TEXT( 'pco_three_limited_internet_access_intro1_text', gProductName)>");
            } else if("<tmpl_var isPcoFive>" == "1") {      
                $("#warningText").removeAttr('class').addClass("warning").html('<tmpl_var _("webui", "pco_add_data_plan_text")>');
                $("#introText").html("<tmpl_var _('webui', 'pco_five_limited_internet_access_intro_text')>&nbsp;<a target='_blank' href='<tmpl_udf GET_EXTERNAL_URI('provider_pco_verizon_link')>'><tmpl_var _('webui', 'pco_verizon_link_text')></a>&nbsp;<tmpl_udf GET_PO_TEXT( 'pco_five_limited_internet_access_intro1_text', gProductName)>");
            }
            $("#warningText").show();
            $("#introText").show();
        } else {
            $("#warningText").addClass("warning");
            $("#buttons").show();
        }
    } else {
        $("#warningText").addClass("note");
        $("#buttons").hide();
    }
});

function noButtonClicked() {
	window.location = "<tmpl_udf GET_URI('apps_home')>";
}

function yesButtonClicked() {
    $("#warningText").hide();
    $("#introText").hide();
    $("#intro1Text").hide();
    $("#buttons").hide();
    $("#spinner").show();
    
	$.ajax({
        url : "<tmpl_udf GET_URI('pcoEvent')>",
        type : "POST",
        dataType : "json",
        data : {
                gSecureToken : "<tmpl_var gSecureToken>"
        },
        success : function(data) {
                linkClicked = true;
        },
        error : function(xhr, textStatus, errorThrown) {
                // If auth session has ended, force a new login with a fresh GET.
                if( (xhr.status == 401) || (xhr.status == 403) || (xhr.status == 406) ) window.location.replace(window.location.href);
        }
    });
}

/* ]]> */
</script>
<div class="pco-container">
    <h2 class="sectionHead" align="center"><tmpl_var _("webui", "pco_header_text")></h2>
    <p id="warningText" class="warning">
        <b><tmpl_var warningText></b>
    </p>

    <p id="introText" class="clearfix">
        <tmpl_var introText>
    </p>

    <p id="intro1Text" class="clearfix">
        <tmpl_var intro1Text>
    </p>

    <div id="buttons" class="button_container clearfix">
        <button type="button" id="pcoNoButton" class="secondary" onClick="noButtonClicked();"><tmpl_var _("webui", "pco_no_button_text")></button>
        <button type="button" id="pcoYesButton" class="secondary" onClick="yesButtonClicked();"><tmpl_var _("webui", "pco_yes_button_text")></button>
    </div>

    <p id="spinner" class="loading" style="display:none;" align="left" >
        <tmpl_var _("webui", "pco_waiting_text")>
        <tmpl_var _("webui", "pco_waiting1_text")>
    </p>

    <a id="homePageLink" class="gohome" href="<tmpl_udf GET_URI('apps_home')>">
        <tmpl_udf GET_PO_TEXT("pco_home_link", gProductName)>
    </a>
</div>
