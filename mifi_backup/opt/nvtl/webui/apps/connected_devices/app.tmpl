<tmpl_if isHidden>
    <div class="notification app error">
        <tmpl_var _("webui", "webui_app_hidden_text")>
    </div>
<tmpl_else>
    <script type="text/javascript">
    var clientListSize = parseInt("<tmpl_var connectedPrimaryWifiDevicesCount>");
    var connectedDevicesSize = parseInt("<tmpl_var connectedDevicesCount>");
    var guestClientListSize = parseInt("<tmpl_var connectedGuestDevicesCount>");
    var totalWiFiClients = clientListSize + guestClientListSize;
    var isEditing = 0;
    var connectedInfoRow;
    var blockedRow;
    var maxBlockedDevices = (isNaN(parseInt("<tmpl_var maxBlockedDevices>"))) ? 0 : parseInt("<tmpl_var maxBlockedDevices>");
    var maxWiFiClients = parseInt("<tmpl_var MaxWiFiClients>");
    var guestWiFiStatus = parseInt("<tmpl_var GuestWifiEnabled>");

    $(function()
    {
        initTableBody();
        refreshDevices(true);

        $("#RefreshList").click(function() {
            isEditing = 0;
            refreshDevices(true);
        });
        $(document).ajaxSuccess(function(e, xhr, settings) {
            if ((xhr.responseText) && (settings.dataType == "json")) {
                try {
                    var obj = jQuery.parseJSON(xhr.responseText || "null");

                    if (typeof obj.statusData.statusBarMaxWiFiClientListSize !== undefined) {
                        var allowedWifiClients = parseInt(obj.statusData.statusBarMaxWiFiClientListSize);
                        if (maxWiFiClients != allowedWifiClients) {
                            maxWiFiClients = allowedWifiClients;
                            var txt = '<tmpl_var _("webui", "connected_devices_change_link")>' + ' ' + '<tmpl_var _("webui", "webui_opening_parenthesis")>' + maxWiFiClients + '<tmpl_var _("webui", "webui_closing_parenthesis")>';
                            $("#ChangeMaxWiFiConnectionsLink").text(txt);
                        }
                    }

                    var refreshDevicesCalled = false;

                    if (typeof obj.statusData.statusBarWiFiClientListSize !== "undefined") {
                        var primarySize = parseInt(obj.statusData.statusBarWiFiClientListSize);

                        if(primarySize != clientListSize) {
                            clientListSize = primarySize;
                            if (isEditing) {
                                $("#RefreshList").show();
                                return;
                            } else {
                                $("#RefreshList").hide();
                            }
                            refreshDevices(true);
                            refreshDevicesCalled = true;
                        }
                    }

                    <tmpl_if GuestWifiSupported>
                        if (typeof obj.statusData.statusBarGuestWifiEnabled !== "undefined") {
                            var guestWifi = parseInt(obj.statusData.statusBarGuestWifiEnabled);
                            if (guestWiFiStatus != guestWifi) {
                                guestWiFiStatus = guestWifi;
                            }
                        }
                        if (guestWiFiStatus && (typeof obj.statusData.statusBarGuestClientListSize !== "undefined")) {
                            var guestSize = parseInt(obj.statusData.statusBarGuestClientListSize);
                            
                            if (guestClientListSize != guestSize) {
                                guestClientListSize = guestSize;
                                if (isEditing) {
                                    $("#RefreshList").show();
                                    return;
                                } else {
                                    $("#RefreshList").hide();
                                }
                                if (!refreshDevicesCalled) refreshDevices(true);
                            }
                        }
                    </tmpl_if>

                    if(totalWiFiClients != (clientListSize + guestClientListSize)) {
                        totalWiFiClients = clientListSize + guestClientListSize;
                        var txt = '<tmpl_var _("webui", "connected_devices_sub_header_text")>' + ' ' + '<tmpl_var _("webui", "webui_opening_parenthesis")>' + totalWiFiClients + '<tmpl_var _("webui", "webui_closing_parenthesis")>';
                        $("#ConnectedDevicesTitle").text(txt);
                    }
                } catch(e) {}
            }
        });


        /**
         * There is a display issue involving the fading in of rows. If the screen is narrow, the table rows are displayed as blocks and not table-rows, they're default state.
         * When the orientation is changed to wide and the width is greater than or equal to 580px, the table rows retain their block state. Rather they show be in table-row state,
         * as widths greater than 580 displays a table. So the page must be refreshed on window width resize to reset table display properties to their defaults.
         */
        var ws = $(window).width();
        $(window).on("resize", function() {
            if ( (ws != $(window).width()) && (ws < 580) ) location.reload();
        });

    });

    /**
     *	initTableBody()
     *
     *	Copy the DOM of the blocked table and the connected tables into memory.
     * 	These will be cloned to create rows as needed. The original DOM elements will be replaced.
     */
    function initTableBody()
    {
        var connectedEl = $("#ConnectedDevicesPrimaryTable tr.deviceInformationRow");
        var blockedEl = $("#BlockedDevicesTable tbody tr");

        // De-uniform the form, if using uniform and these rows have been uniformed.
        // Uniform 2 will only restore DOM elements, so we do this first, then clone.
        if (jQuery.uniform) {
            // This is for uniform 1 and uniform 2 compatibility.
            var uniformOptions = (typeof $.uniform.options !== "undefined") ? $.uniform.options : $.uniform.defaults;
            if (uniformOptions.filter) {
                $.uniform.restore(connectedEl.find(uniformOptions.filter));
                $.uniform.restore(blockedEl.find(uniformOptions.filter));
            }
        }
        // Clone the row structures into memory.
        connectedInfoRow = connectedEl.clone();
        blockedRow = blockedEl.clone();
    }

    /**
     * refreshDevices()
     *
     * Empty the blocked table and the connected tables, reset the layout, and get new data from CCM.
     */
    function refreshDevices(getDeviceData)
    {
        // Remove old data rows.
        $("#ConnectedDevicesPrimaryTable tbody, #BlockedDevicesTable tbody").empty();
        $(".no_devices").hide();
        // Showing the loaders.
        $(".loading").show();
        // Get the devices data.
        if (getDeviceData) {
            getDevicesdata();
        }
    }

    /**
     * getDeviceData()
     *
     * Kicks off the AJAX call to get new data about connected, connected guest, and blocked devices
     *
     * Once we have data back, it will kick off the Build Table methods.
     */
    function getDevicesdata()
    {
        if (isEditing) return;
        $.ajax({
            url : "<tmpl_udf GET_URI('connected_devices_refresh')>",
            type : "GET",
            dataType : "json",
            success : function(data) {
                //check if there is data. if so, make the table. if not, show no devices message.
                $(".loading").hide();
		connectedDevicesSize = parseInt(data["connectedDevicesCount"]);
                if(data["connectedDevicesList"].length > 0){
                    clientListSize = parseInt(data["connectedPrimaryWifiDevicesCount"]);
                    buildTableFromJson(data["connectedDevicesList"], "ConnectedDevicesPrimary", data["blockedDevicesList"].length);
                    $("#ConnectedDevicesPrimaryTable").show();
                } else {
                    // Ideally this case should never occur.
                    console.log("connectedDevicesList is empty");
                }

                if(data["connectedGuestDevicesList"].length > 0){
                    guestClientListSize = data["connectedGuestDevicesList"].length;					
                    buildTableFromJson(data["connectedGuestDevicesList"], "ConnectedDevicesGuest", data["blockedDevicesList"].length);
                }

                var text = '<tmpl_var _("webui", "connected_devices_block_devices_sub_header_text")>' + ' ' + '<tmpl_var _("webui", "webui_opening_parenthesis")>' +  data["blockedDevicesCount"] + '<tmpl_var _("webui", "webui_closing_parenthesis")>';

                $("#BlockedDevicesTitle").text(text);
                if(data["blockedDevicesCount"] > 0) {
                    $("#BlockedDevicesCountZero").hide();					
                    buildTableFromJson(data["blockedDevicesList"], "BlockedDevices", data["blockedDevicesCount"]);
                    $("#BlockedDevicesTable").show();
                } else {
                    $("#BlockedDevicesTable thead").find("tr").show();
                    $("#BlockedDevicesCountZero").show();
                }
            },
            error : function(xhr, textStatus, errorThrown) {
                // If auth session has ended, force a new login with a fresh GET.
                if( (xhr.status == 401) || (xhr.status == 403) || (xhr.status == 406) ) window.location.replace(window.location.href);
            }
        });
    }

    /**
     * buildNewRow()
     *
     * rowType: string - connected, connectedGuest
     * index: integer - row index
     * localId: string - added to existing name and id attributes to make them unique in the DOM.
     * interfaceType: string - interface type
     * $el: object - jQuery DOM object
     *
     * returns the new row
     *
     * Clone a new display row from the one stored in memory.
     * Give it a unique id. Add an edit button to expose the edit row.
     */
    function buildNewRow(rowType, index, localId, interfaceType, macAddress, deviceType, hostname, displayName, $el)
    {
        var newRow = $el.clone();
        newRow.attr("id", rowType + index);

        // Set the value for the device name input.
        var editDeviceName = newRow.find("input.friendlyname");
        editDeviceName.val(displayName);

        newRow.find(".deviceInformation").attr("id", "deviceInformation_" + index)
        newRow.find(".hostName").attr("id", "hostName_" + index)

        /**
         * Bind the click event to process the edits.
         */
        newRow
            .find(".save")
            .on("click", function() {
                var saveName = (editDeviceName.val() == "") ? hostname : editDeviceName.val();
                saveName = (saveName == "") ? "Unknown" : saveName; /* Prevent sending blank name for unknown hostnames */
                if( containsPrintable(saveName) ) {
                    // Prevent multiple clicks.
                    $(this).off("click");
                    $.post("<tmpl_udf GET_URI('connected_devices_custom_device')>", {
                        type : deviceType,
                        name : saveName,
                        bssid : macAddress,
                        gSecureToken : "<tmpl_var gSecureToken>"
                    }, function(data) {
                        isEditing = 0;
                        refreshDevices(true);
                    });
                } else {
                    clearErrors();
                    newRow.find("input.friendlyname").append('<p class="error">' + '<tmpl_var _("webui", "connected_devices_invalid_name")>' + '</p>');
                }
            });

        /**
         * Give the edit button a unique id and bind the click event
         * to hide the info row and show the edit row.
         */
        newRow
            .find(".edit")
            .attr("id", "editLink_" + index)
            .on("click", function() {
                // Hide any open edit rows.
                if($("#hostName_" + index).css('display') == 'none') {
                    $("#hostName_" + index).show();
                    $("#deviceInformation_" + index).hide();
                    $("#editLink_" + index + " #dropdown").removeClass().addClass("down_arrow");
                    editDeviceName.val((displayName == "") ? hostname : displayName);
                    isEditing = isEditing - 1;
                } else {
                    $("#hostName_" + index).hide();
                    $("#deviceInformation_" + index).fadeIn("slow");
                    $("#editLink_" + index + " #dropdown").removeClass().addClass("up_arrow");
                    isEditing = isEditing + 1;
                }
            });

        newRow.find(".interfaceType span")
            .attr("title", interfaceType)
            .removeClass()
            .addClass(interfaceType.toLowerCase());

        return newRow;
    }

    /**
     * containsPrintable()
     *
     * str: string - unicode string to test
     *
     * returns boolean
     *
     * Test if string contains printable characters and no control characters.
     */
    function containsPrintable(str)
    {
        return /^[\u0020-\uFFFF]*$/.test(str);
    }

    /**
     * clearErrors()
     *
     * Remove any error elements added to the DOM.
     */
    function clearErrors()
    {
        $(".notification, .inline_error, .error").remove();
    }

    /**
     * postBlockUnblockData()
     *
     * newRow: object - jQuery DOM object
     * rowType: string - connected, connectedGuest
     * id: integer - row index
     *
     * Refresh Devices kicks off the AJAX call to get new data about connected and
     * blocked devices
     *
     * Once we have data back, it will kick off the Build Table methods.
     */
    function postBlockUnblockData(newRow, rowType, id)
    {
        var postUrl = ( rowType === "ConnectedDevicesPrimaryRow" ) ? "<tmpl_udf GET_URI('connected_devices_block_device')>"  : "<tmpl_udf GET_URI('connected_devices_unblock_device')>";
        $.post(postUrl, {
            deviceType : newRow.attr("data-type"),
            hostname : newRow.attr("data-friendlyname"),
            bssid : newRow.attr("data-mac"),
            gSecureToken : "<tmpl_var gSecureToken>"
        },
        function(data) { 
            isEditing = 0;
            $("#" + rowType + id).remove();
            refreshDevices(true);
        }).fail(function() {
            refreshDevices(true);
        });
    }

    /**
     * updateUniformElements()
     *
     * $el: object - jQuery DOM object
     *
     * If using the Uniform jQuery plugin, reapply uniform features to specific form elements in the DOM
     */
    function updateUniformElements($el)
    {
        if (jQuery.uniform) {
            // This is for uniform 1 and uniform 2 compatibility.
            var uniformOptions = (typeof $.uniform.options !== "undefined") ? $.uniform.options : $.uniform.defaults;
            if (uniformOptions.filter) {
                if (typeof $el !== "undefined") {
                    $el.find(uniformOptions.filter).uniform();
                } else {
                    $(uniformOptions.filter).uniform();
                }
            }
        }
    }

    /**
     * buildTableFromJson()
     *
     * data: object - AJAX result
     * type: string - blocked, connected, or connectedGuest
     * blockedListSize: integer - length of blocked devices list
     *
     * Builds new rows using AJAX result data. Gives rows appropriate attributes and event handling.
     * These rows are replace rows in the existing tbody elements.
     */
    function buildTableFromJson(data, type, blockedListSize)
    {
        var newTableBody;
        var index = 0;
        if (type == "ConnectedDevicesGuest") {
            type = "ConnectedDevicesPrimary";
            if (connectedDevicesSize == 0) {
                newTableBody = $("#" + type + "Table tbody").empty();
            } else {
                newTableBody = $("#" + type + "Table tbody");
                index = connectedDevicesSize;
            }
        } else {
            newTableBody = $("#" + type + "Table tbody").empty();
        }
        var rowType = type + "Row";
        

        //Loop each row of Devices.
        $.each(data, function(id, value) {
            var newRow;
            id = id + index;
            var localId = type + "_" + id;
            var displayName = this.name;
            displayName = (displayName == "") ? this.hostname : displayName;
            displayName = ((displayName == "")||(typeof displayName == "undefined")) ? "Unknown" : displayName;
            // Remove any entity encoding. It's not needed because jQuery will post as plain text.
            var decoded = $('<div/>').html(displayName).text();
            displayName = decoded;

	     if (type == "ConnectedDevicesPrimary"){
                newRow = buildNewRow(rowType, id, localId, this.interfaceType, this.macAddress, this.type, this.hostname, displayName, connectedInfoRow);
            } else {
                newRow = blockedRow.clone();
                newRow.attr("id", rowType + id);
                newRow.attr("whitelist", this.whitelist);
            }

            // Do all the stuff both rows have in common.
            newRow.attr("data-mac", this.macAddress);
            newRow.attr("data-type", this.type);
            newRow.attr("data-hostname", this.hostname);
            newRow.attr("data-friendlyname", displayName);

            newRow.find(".hostName").text(displayName);
            newRow.find(".ipAddress").text(this.ipAddress);
            newRow.find(".macAddress").text(this.macAddress);
            newRow.find(".linkLocal").text(this.linkLocal);
            newRow.find(".networkType").text(this.networkType);

            var buttonCol = newRow.find(".buttonColumn");
            buttonCol.find("button").on("click", function() {
                if( type == "ConnectedDevicesPrimary" ) {
                    if(("<tmpl_var ShowBlockedLimitCheck>" === "1") && blockedListSize >= maxBlockedDevices) {
                        modalPopup.createWindow(
                            '<tmpl_var _("webui", "connected_devices_max_blocked_modal_title")>',
                            '<p><tmpl_var _("webui", "connected_devices_max_blocked_modal_text")></p>',
                            430, 250,
                            [{
                                text : '<tmpl_var _("webui", "webui_modal_ok_button")>',
                                className : "primary",
                                trigger : function(){}
                            }]
                        );
                    } else {
                        refreshDevices(false);
                        postBlockUnblockData( newRow, rowType, id);
                    }
                } else {
                    if(("<tmpl_var macFilterEnabled>" === "on") && (newRow.attr("whitelist") === "false")) {
                        modalPopup.createWindow(
                            '<tmpl_var _("webui", "connected_devices_unblock_modal_title")>',
                            "<p><tmpl_var _('webui', 'connected_devices_unblock_modal_text')></p>",
                            430, 250,
                            [{
                                text : '<tmpl_var _("webui", "webui_modal_ok_button")>',
                                className : "primary",
                                trigger : function() {
                                    refreshDevices(false);
                                    postBlockUnblockData(newRow, rowType, id);
                                }
                            }]
                        );
                    } else {
                        refreshDevices(false);
	                    postBlockUnblockData(newRow, rowType, id);
                    }
                }
            });

            // If this device can not be blocked, add it here.
            if (this.disableBlock ) {
                buttonCol.find("button").remove();
            }
            if (type == "BlockedDevices") {
                buttonCol.find("button").attr("title", '<tmpl_var _("webui", "connected_devices_unblock_button_hover_text")>');
                <tmpl_if ConnectedDeviceUnblockShow>
                    <tmpl_if ConnectedDeviceUnblockLocked>
                        buttonCol.find("button").prop("disabled", true);
                        buttonCol.find("button").removeAttr("title");
                    </tmpl_if>
                <tmpl_else>
                    buttonCol.find("button").remove();
                </tmpl_if>
            } else {
                <tmpl_if ConnectedDeviceEditShow>
                    <tmpl_if ConnectedDeviceEditLocked>
                        newRow.find(".edit").prop("disabled", true);
                    </tmpl_if>
                <tmpl_else>
                    newRow.find(".edit").remove();
                </tmpl_if>
                <tmpl_if ConnectedDeviceBlockShow>
                    <tmpl_if ConnectedDeviceBlockLocked>
                        buttonCol.find("button").prop("disabled", true);
                        buttonCol.find("button").removeAttr("title");
                    </tmpl_if>
                <tmpl_else>
                    buttonCol.find("button").remove();
                </tmpl_if>
            }
            if(this.disableBlock) {
                newTableBody.prepend(newRow);
            } else {
                newTableBody.append(newRow);
            }
        });

        //Fade in the rows since they start out hidden.
        $("#" + type + "Table").find("tr").fadeIn("slow");

        updateUniformElements($("#" + type + "Table tbody"));
    }

    </script>

    <tmpl_if isLocked>
        <div class="notification app error">
            <tmpl_var _("webui", "webui_app_locked_text")>
        </div>
    </tmpl_if>

    <tmpl_if errorCount>
        <div class="notification app error">
            <div class="notification_inner">
                <tmpl_var _("webui", "webui_save_code_failed_text")>
            </div>
        </div>
    </tmpl_if>

    <tmpl_if gPostSuccess>
        <div class="notification app success">
            <div class="notification_inner">
                <tmpl_var _("webui", "webui_save_code_success_text")>
            </div>
        </div>
    </tmpl_if>

    <!-- connected devices - START -->
    <fieldset class="first">
        <h3 id="ConnectedDevicesTitle" class="tableHeader sectionHead clearfix"><tmpl_var _("webui", "connected_devices_sub_header_text")>&nbsp;<tmpl_var _("webui", "webui_opening_parenthesis")><tmpl_var totalConnectedDevicesCount><tmpl_var _("webui", "webui_closing_parenthesis")></h3>

        <p class="note" id="RefreshList" style="display:none;">
            <tmpl_var _("webui", "connected_devices_list_not_updated_text")> <a href="#" id="RefreshList"> <tmpl_var _("webui", "connected_devices_refresh_link_text")> </a>
        </p>

        <p id="ConnectedDevicesPrimaryUpdatingData" class="loading">
            <tmpl_var _("webui", "connected_devices_searching_for_devices_text")>
        </p>

        <table id="ConnectedDevicesPrimaryTable" class="devicesTable">
            <colgroup>
                <col class="interfaceType" />
                <col class="deviceName" />
                <col class="networkType" />
                <col class="buttonColumn" />
                <col class="edit" />
            </colgroup>
            <thead>
                <tr>
                    <th><tmpl_var _("webui", "connected_device_label")></th>
                    <th></th>
                    <th><tmpl_var _("webui", "connected_device_network_label")></th>
                    <th><tmpl_var _("webui", "connected_device_block_label")></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr data-mac="" data-friendlyname="" data-hostname="" data-type=""  class="deviceInformationRow">
                    <td class="interfaceType"><span>&nbsp;</span></td>
                    <td class="deviceName">
                        <div class="hostName">&nbsp;</div>
                        <div class="deviceInformation" style="display:none;">
                            <input class="friendlyname text long" id="editName" name="editName" type="text" maxlength="32" value="" />
                            <input type="checkbox" name="saveDeviceName" class="save"/>
                            <p><tmpl_var _("webui", "connected_devices_ip_address_label")><span class="ipAddress"></span></p>
                            <p><tmpl_var _("webui", "connected_devices_mac_address_label")> <span class="macAddress"></span></p>
                            <tmpl_if isIPv6Supported><p><tmpl_var _("webui", "connected_devices_link_local_label")> <span class="linkLocal"></span></p></tmpl_if>
                        </div>
                    </td>
                    <td class="networkType">&nbsp;</td>
                    <td class="buttonColumn">
                        <tmpl_if ConnectedDeviceBlockShow>
                            <button class="blockDevice secondary" type="button" <tmpl_if ConnectedDeviceBlockLocked>disabled="disabled"</tmpl_if> <tmpl_if isLocked> disabled="disabled"</tmpl_if>>
                                <tmpl_var _("webui", "connected_devices_block_button_text")>
                            </button>
                        </tmpl_if>
                    </td>
                    <td class="edit">
                        <tmpl_if ConnectedDeviceEditShow>
                            <button type="button" id="dropdown" class="down_arrow" title='<tmpl_var _("webui", "connected_devices_edit_device_hover_text")>' <tmpl_if ConnectedDeviceEditLocked>disabled="disabled"</tmpl_if>>
                                <tmpl_var _("webui", "connected_devices_edit_device_button_text")>
                            </button>
                        </tmpl_if>
                    </td>
                </tr>
	        </tbody>
        </table>
        <p class="clearfix">
            <span class="changeLink">
                <a href="<tmpl_var wifiRedirectionLink>" id="ChangeMaxWiFiConnectionsLink"><tmpl_var _("webui", "connected_devices_change_link")>&nbsp;<tmpl_var _("webui", "webui_opening_parenthesis")><tmpl_var MaxWiFiClients><tmpl_var _("webui", "webui_closing_parenthesis")>
                </a>
            </span>
        </p>
    </fieldset>
    <!-- connected devices - END -->

    <!-- Blocked devices - BEGIN -->
    <fieldset class="last">
        <h3 id="BlockedDevicesTitle" class="tableHeader sectionHead"><tmpl_var _("webui", "connected_devices_block_devices_sub_header_text")>&nbsp;<tmpl_var _("webui", "webui_opening_parenthesis")><tmpl_var blockedDevicesCount><tmpl_var _("webui", "webui_closing_parenthesis")></h3>
        <p id="BlockedDevicesUpdatingData" class="loading">
            <tmpl_var _("webui", "connected_devices_searching_for_blocked_devices_text")>
        </p>

        <table id="BlockedDevicesTable" class="devicesTable">
            <colgroup>
                <col class="icon" />
                <col class="deviceName" />
                <col class="buttonColumn" />
            </colgroup>
            <thead>
                <tr>
                    <th><tmpl_var _("webui", "connected_device_label")></th>
                    <th></th>
                    <th><tmpl_var _("webui", "connected_device_block_label")></th>
                </tr>
            </thead>
            <tbody>
                <tr data-mac="" data-whitelist="" class="deviceInformationRow">
                    <td class="icon"><span class="Generic">&nbsp;</span></td>
                    <td class="deviceName">
                        <div class="hostName">&nbsp;</div>
                        <p><tmpl_var _("webui", "connected_devices_mac_address_label")> <span class="macAddress"></span></p>
                    </td>
                    <td class="buttonColumn">
                        <tmpl_if ConnectedDeviceUnblockShow>
                            <button class="unblockDevice secondary" type="button" <tmpl_if ConnectedDeviceUnblockLocked>disabled="disabled"</tmpl_if> <tmpl_if isLocked> disabled="disabled"</tmpl_if>>
                                <tmpl_var _("webui", "connected_devices_unblock_button")>
                            </button>
                        </tmpl_if>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="row clearfix no_devices" id="BlockedDevicesCountZero">
            <div class="col icon" >
            </div>
            <div class="col text">
                <p>
                    <tmpl_var _("webui", "connected_devices_empty_blocked_list_text")>
                </p>
            </div>
        </div>

    </fieldset>
    <!-- Blocked devices - END -->
</tmpl_if>
